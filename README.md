# IoT and A.I. Servers Docker Setup
IoT devices trigger and send data to MQTT server and other clients subscribed to MQTT can get the data and process. 

(diagram of the servers)


## 1. Clone repository
```
> cd <root directory of the project workspace>
> git clone https://github.com/frankie-2nfro-com/iot_servers.git
```

## 2. Create a .env file to store credential information
```
INFLUXDB_USERNAME=admin
INFLUXDB_PASSWORD=<admin password of influxdb>
INFLUXDB_ORG=<organization name>
INFLUXDB_BUCKET=<bucket name>

WATCHTOWER_TOKEN_FOR_MODEL_SERVER=<watchtower token for accessing docker hub>
```

## 3. Run the services
```
> docker compose --env-file ../docker_workspace.env up -d
```
(to check if all services is up normally, you can open the docker desktop to make sure all are up and running)



## 4. Access the services

### MQTT Broker
You can send data to MQTT Broker by localhost:1883 with username and password which are setup in ./opt/mosquitto/config/password.txt. The file is generated by mqtt server host shell as follows:
```
> sudo mosquitto_passwd -c /mosquitto/config/password.txt <username>
```
(type the password in the prompt and the password.txt file will be created)

To test the mqtt server, you can either use mosquitto CLI tool or python script to test:
```
mosquitto_sub -h 127.0.0.1 -t "iot1" -u frankiesiu -P frankie01
mosquitto_pub -h 127.0.0.1 -m "test test" -t "iot1" -u frankiesiu -P frankie01
```

### Node-Red
You can create data flow by accessing: http://localhost:1880/


### InfluxDB
You can administrate InfluxDB by accessing: http://localhost:8086/


### cAdvisor
You can monitor server resources by accessing: http://localhost:8080/


### Grafana
You can create dashbroad to monitor data by accessing: http://localhost:3000/
